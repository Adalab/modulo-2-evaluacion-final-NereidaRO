"use strict";console.log("The script is linked!");const searchListHTML=document.querySelector(".js-search-list"),favListHTML=document.querySelector(".js-fav-list"),inputSearch=document.querySelector(".js-input-search"),buttonSearch=document.querySelector(".js-button-search"),buttonReset=document.querySelector(".js-button-reset"),savedFavs=JSON.parse(localStorage.getItem("saved"));let foundedAnimes=[],favourites=[];function onLoad(){savedFavs&&(favourites=savedFavs,renderAnime(favourites,favListHTML))}function writeAnime(e){let n="";for(const t of e)console.log(t.image),"https://cdn.myanimelist.net/img/sp/icon/apple-touch-icon-256.png"===t.image?n+=`<li class="js-li-anime" id="${t.id}">\n        <img src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV" />\n        <h6>${t.title}<h6>\n        </li>`:n+=`<li class="js-li-anime" id="${t.id}">\n        <img src="${t.image}" />\n        <h6>${t.title}<h6>\n        </li>`;return n}function listenAnime(){const e=document.querySelectorAll(".js-li-anime");for(const n of e)n.addEventListener("click",handleFav)}function renderAnime(e,n){n.innerHTML=writeAnime(e),listenAnime()}function saveFav(){null===savedFavs&&localStorage.setItem("saved",JSON.stringify(favourites))}function searchAnime(){const e=inputSearch.value.toLowerCase();fetch("https://api.jikan.moe/v4/anime?q="+e).then(e=>e.json()).then(e=>{let n=e.data;foundedAnimes=n.map(({mal_id:e,title:n,images:t})=>({id:e,title:n,image:t.jpg.image_url})),console.log(foundedAnimes),renderAnime(foundedAnimes,searchListHTML)})}function handleSearch(e){e.preventDefault(),searchAnime()}function handleReset(e){e.preventDefault(),localStorage.clear(),foundedAnimes=[],favourites=[],inputSearch.value="",renderAnime(favourites,favListHTML),renderAnime(foundedAnimes,searchListHTML)}function handleFav(e){const n=e.currentTarget.id,t=foundedAnimes.find(e=>e.id===parseInt(n)),i=favourites.findIndex(e=>e.id===parseInt(n));console.log(t),console.log(i),-1===i?(favourites.push(t),console.log(favourites)):favourites.splice(i,1),saveFav(),renderAnime(favourites,favListHTML)}onLoad(),buttonSearch.addEventListener("click",handleSearch),buttonReset.addEventListener("click",handleReset);