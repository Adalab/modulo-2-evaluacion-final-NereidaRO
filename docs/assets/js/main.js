"use strict";console.log("The script is linked");const searchListHTML=document.querySelector(".js-search-list"),favListHTML=document.querySelector(".js-fav-list"),inputSearch=document.querySelector(".js-input-search"),buttonSearch=document.querySelector(".js-button-search"),buttonReset=document.querySelector(".js-button-reset"),savedFavs=JSON.parse(localStorage.getItem("saved"));let foundedAnimes=[],favourites=[];function writeAnime(){let e="";for(const n of foundedAnimes)"https://cdn.myanimelist.net/img/sp/icon/apple-touch-icon-256.png"===n.image?e+=`<li class="js-li-anime" id="${n.id}">\n        <img class="main__img" src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV" />\n        <h6 class="main__h6">${n.title}</h6>\n        </li>`:e+=`<li class="js-li-anime" id="${n.id}">\n        <img class="main__img" src="${n.image}" />\n        <h6 class="main__h6">${n.title}</h6>\n        </li>`;return e}function listenAnime(){const e=document.querySelectorAll(".js-li-anime");for(const n of e)n.addEventListener("click",handleFav)}function renderAnime(){searchListHTML.innerHTML=writeAnime(),listenAnime()}function saveFav(){localStorage.setItem("saved",JSON.stringify(favourites))}function compareArray(){const e=document.querySelectorAll(".js-li-anime");for(const n of e){let e=parseInt(n.id);-1!==favourites.findIndex(n=>n.id===e)?n.classList.add("fav"):n.classList.remove("fav")}}function writeFavs(){let e="";for(const n of favourites)"https://cdn.myanimelist.net/img/sp/icon/apple-touch-icon-256.png"===n.image?e+=`<li class="js-li-fav" id="${n.id}"><i class="js-x fa-solid fa-xmark" id="${n.id}"></i>\n        <img class="main__img" src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV" />\n        <h6 class="main__h6">${n.title}</h6>\n        </li>`:e+=`<li class="js-li-fav" id="${n.id}"><i class="js-x fa-solid fa-xmark" id="${n.id}"></i>\n        <img class="main__img" src="${n.image}" />\n        <h6 class="main__h6">${n.title}</h6>\n        </li>`;return e}function renderFavs(){favListHTML.innerHTML=writeFavs();const e=document.querySelectorAll(".js-x");console.log(e),listenIcons(e)}function listenIcons(e){for(const n of e)n.addEventListener("click",handleIcon)}function onLoad(){savedFavs&&(favourites=savedFavs,renderFavs())}function searchAnime(){const e=inputSearch.value.toLowerCase();fetch("https://api.jikan.moe/v4/anime?q="+e).then(e=>e.json()).then(e=>{let n=e.data;foundedAnimes=n.map(({mal_id:e,title:n,images:i})=>({id:e,title:n,image:i.jpg.image_url})),console.log(foundedAnimes),renderAnime(),compareArray()})}function handleSearch(e){e.preventDefault(),searchAnime()}function handleReset(e){e.preventDefault(),localStorage.clear(),foundedAnimes=[],favourites=[],inputSearch.value="",renderAnime(),renderFavs()}function handleFav(e){const n=e.currentTarget.id,i=foundedAnimes.find(e=>e.id===parseInt(n)),t=favourites.findIndex(e=>e.id===parseInt(n));console.log(i),console.log(t),-1===t?(favourites.push(i),console.log(favourites),compareArray()):(favourites.splice(t,1),compareArray()),saveFav(),renderFavs()}function handleIcon(e){const n=parseInt(e.currentTarget.id);console.log(n);const i=favourites.findIndex(e=>e.id===n);console.log(i),-1!==i&&favourites.splice(i,1),saveFav(),renderFavs(),compareArray()}onLoad(),buttonSearch.addEventListener("click",handleSearch),buttonReset.addEventListener("click",handleReset);